{
  if (useRequire) {
    URI uri;
    if (path == null) {
      uri=new File(System.getProperty("user.dir")).toURI();
    }
 else {
      if (SourceReader.toUrl(path) != null) {
        try {
          uri=new URI(path);
        }
 catch (        URISyntaxException x) {
          uri=new File(path).toURI();
        }
      }
 else {
        uri=new File(path).toURI();
      }
    }
    return new ModuleScope(global,uri,null);
  }
 else {
    return global;
  }
}
