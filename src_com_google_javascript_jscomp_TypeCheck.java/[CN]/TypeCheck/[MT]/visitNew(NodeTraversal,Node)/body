{
  Node constructor=n.getFirstChild();
  JSType type=getJSType(constructor).restrictByNotNullOrUndefined();
  if (type.isConstructor() || type.isEmptyType() || type.isUnknownType()) {
    FunctionType fnType=type.toMaybeFunctionType();
    if (fnType != null) {
      visitParameterList(t,n,fnType);
      ensureTyped(t,n,fnType.getInstanceType());
    }
 else {
      ensureTyped(t,n);
    }
  }
 else {
    if (constructor.getType() != Token.GETPROP) {
      Node line;
      if (constructor.getLineno() < 0 || constructor.getCharno() < 0) {
        line=n;
      }
 else {
        line=constructor;
      }
      report(t,line,NOT_A_CONSTRUCTOR);
    }
    ensureTyped(t,n);
  }
}
