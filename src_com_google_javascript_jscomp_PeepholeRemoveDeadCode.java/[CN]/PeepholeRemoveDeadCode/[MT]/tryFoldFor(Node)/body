{
  Preconditions.checkArgument(n.getType() == Token.FOR);
  if (NodeUtil.isForIn(n)) {
    return n;
  }
  Node init=n.getFirstChild();
  Node cond=init.getNext();
  Node increment=cond.getNext();
  if (init.getType() != Token.EMPTY && init.getType() != Token.VAR) {
    init=trySimpilifyUnusedResult(init,false);
  }
  if (increment.getType() != Token.EMPTY) {
    increment=trySimpilifyUnusedResult(increment,false);
  }
  if (n.getFirstChild().getType() != Token.EMPTY) {
    return n;
  }
  if (NodeUtil.getImpureBooleanValue(cond) != TernaryValue.FALSE) {
    return n;
  }
  NodeUtil.redeclareVarsInsideBranch(n);
  if (!mayHaveSideEffects(cond)) {
    NodeUtil.removeChild(n.getParent(),n);
  }
 else {
    Node statement=new Node(Token.EXPR_RESULT,cond.detachFromParent()).copyInformationFrom(cond);
    n.getParent().replaceChild(n,statement);
  }
  reportCodeChange();
  return null;
}
