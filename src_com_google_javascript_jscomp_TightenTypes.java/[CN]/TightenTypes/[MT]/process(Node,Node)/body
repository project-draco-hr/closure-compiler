{
  topScope=new ConcreteScope(null);
  topScope.initForExternRoot(externRoot);
  topScope.initForScopeRoot(jsRoot);
  long maxIterations=1000;
  long iterations=0;
  Set<ConcreteScope> workSet=Sets.newHashSet(topScope);
  List<ConcreteScope> workList=Lists.newArrayList(topScope);
  boolean changed;
  do {
    changed=false;
    for (int i=0; i < workList.size(); ++i) {
      ConcreteScope scope=workList.get(i);
      for (      Action action : scope.getActions()) {
        for (        Assignment assign : action.getAssignments(scope)) {
          if (assign.slot.addConcreteType(assign.type)) {
            changed=true;
            ConcreteScope varScope=assign.slot.getScope();
            if ((varScope != scope) && !workSet.contains(varScope)) {
              workSet.add(varScope);
              workList.add(varScope);
            }
          }
        }
      }
    }
    Preconditions.checkState(++iterations != maxIterations,NON_HALTING_ERROR_MSG);
  }
 while (changed);
}
