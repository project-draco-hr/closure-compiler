{
  Object obj;
  boolean cacheObj;
  if (t instanceof JavaScriptException) {
    cacheObj=false;
    obj=((JavaScriptException)t).getValue();
  }
 else {
    cacheObj=true;
    if (lastCatchScope != null) {
      NativeObject last=(NativeObject)lastCatchScope;
      obj=last.getAssociatedValue(t);
      if (obj == null)       Kit.codeBug();
    }
 else {
      obj=wrapException(t,scope,cx);
    }
  }
  NativeObject catchScopeObject=new NativeObject();
  catchScopeObject.defineProperty(exceptionName,obj,ScriptableObject.PERMANENT);
  if (isVisible(cx,t)) {
    catchScopeObject.defineProperty("__exception__",Context.javaToJS(t,scope),ScriptableObject.PERMANENT | ScriptableObject.DONTENUM);
  }
  if (cacheObj) {
    catchScopeObject.associateValue(t,obj);
  }
  return catchScopeObject;
}
