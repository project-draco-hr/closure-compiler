{
  SimpleErrorReporter reporter=new SimpleErrorReporter();
  final JSTypeRegistry typeRegistry=new JSTypeRegistry(reporter);
  StaticScope<JSType> scope=new StaticScope<JSType>(){
    public StaticSlot<JSType> getSlot(    final String name){
      return new SimpleSlot(name,typeRegistry.getNativeType(JSTypeNative.UNKNOWN_TYPE),false);
    }
    public StaticSlot<JSType> getOwnSlot(    String name){
      return getSlot(name);
    }
    public StaticScope<JSType> getParentScope(){
      return null;
    }
    public JSType getTypeOfThis(){
      return null;
    }
  }
;
  ObjectType namedType=(ObjectType)typeRegistry.getType(scope,"Foo",null,0,0);
  FunctionType functionType=typeRegistry.createFunctionType(namedType);
  typeRegistry.setLastGeneration(false);
  typeRegistry.resolveTypesInScope(scope);
  assertTrue(functionType.getReturnType().isUnknownType());
  functionType.resolve(reporter,scope);
  assertTrue(functionType.getReturnType().isUnknownType());
  typeRegistry.declareType("Foo",typeRegistry.createAnonymousObjectType());
  typeRegistry.resolveTypesInScope(scope);
  assertTrue(functionType.getReturnType().isUnknownType());
  assertNull("Unexpected errors: " + reporter.errors(),reporter.errors());
  assertNull("Unexpected warnings: " + reporter.warnings(),reporter.warnings());
  typeRegistry.incrementGeneration();
  typeRegistry.setLastGeneration(true);
  typeRegistry.resolveTypesInScope(scope);
  assertFalse(functionType.getReturnType().isUnknownType());
}
