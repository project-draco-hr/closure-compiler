{
  Node lhs=expr.getFirstChild();
  Node rhs=expr.getLastChild();
  EnvTypePair lhsPair=analyzeExprFwd(lhs,inEnv);
  EnvTypePair rhsPair=analyzeExprFwd(rhs,lhsPair.env);
  if (lhsPair.type.isScalar() && !rhsPair.type.isScalar()) {
    rhsPair=analyzeExprFwd(rhs,lhsPair.env,lhsPair.type);
  }
 else   if (rhsPair.type.isScalar()) {
    lhsPair=analyzeExprFwd(lhs,inEnv,rhsPair.type);
    rhsPair=analyzeExprFwd(rhs,lhsPair.env,rhsPair.type);
  }
 else   if (lhs.isName() && lhsPair.type.isUnknown() && rhs.isName()&& rhsPair.type.isUnknown()) {
    TypeEnv env=envPutType(rhsPair.env,lhs.getString(),JSType.TOP_SCALAR);
    env=envPutType(rhsPair.env,rhs.getString(),JSType.TOP_SCALAR);
    return new EnvTypePair(env,JSType.BOOLEAN);
  }
  JSType lhsType=lhsPair.type;
  JSType rhsType=rhsPair.type;
  if (!lhsType.isSubtypeOf(JSType.TOP_SCALAR) || !rhsType.isSubtypeOf(JSType.TOP_SCALAR) || !JSType.areCompatibleScalarTypes(lhsType,rhsType)) {
    warnInvalidOperand(expr,expr.getType(),"matching scalar types",lhsType.toString() + ", " + rhsType.toString());
  }
  rhsPair.type=JSType.BOOLEAN;
  return rhsPair;
}
