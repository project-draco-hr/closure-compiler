{
  Node receiver=expr.getFirstChild();
  Node index=expr.getLastChild();
  JSType reqObjType=pickReqObjType(expr);
  EnvTypePair pair=analyzeExprFwd(receiver,inEnv,reqObjType);
  pair=mayWarnAboutNullableReferenceAndTighten(receiver,pair.type,pair.env,JSType.TOP_OBJECT);
  JSType recvType=pair.type.autobox(commonTypes);
  if (!mayWarnAboutNonObject(receiver,"",recvType,specializedType) && !mayWarnAboutStructPropAccess(receiver,recvType)) {
    if (isArrayType(recvType) || recvType.equals(commonTypes.getArgumentsArrayType())) {
      pair=analyzeExprFwd(index,pair.env,JSType.NUMBER);
      if (!commonTypes.isNumberScalarOrObj(pair.type)) {
        warnings.add(JSError.make(index,NewTypeInference.NON_NUMERIC_ARRAY_INDEX,pair.type.toString()));
      }
      if (isArrayType(recvType)) {
        pair.type=getArrayElementType(recvType);
        Preconditions.checkState(pair.type != null,"Array type %s has no element type at node: %s",recvType,expr);
      }
 else {
        pair.type=envGetType(pair.env,ARGSARRAYELM_ID);
      }
      return pair;
    }
 else     if (index.isString()) {
      return analyzePropAccessFwd(receiver,index.getString(),inEnv,requiredType,specializedType);
    }
  }
  pair=analyzeExprFwd(index,pair.env);
  pair.type=requiredType;
  return pair;
}
