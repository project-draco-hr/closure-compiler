{
  Map<Var,ReferenceCollection> scriptMap=Maps.newHashMap();
  map.updateGlobalVarReferences(scriptMap,scriptRoot);
  ReferenceCollection refs=map.getReferences(globalScope.getVar(VAR2));
  assertEquals(var2Refs.references,refs.references);
  refs=map.getReferences(globalScope.getVar(VAR1));
  assertEquals(2,refs.references.size());
  assertEquals(var1Refs.references.get(0),refs.references.get(0));
  assertEquals(var1Refs.references.get(2),refs.references.get(1));
  refs=map.getReferences(globalScope.getVar(VAR3));
  assertEquals(1,refs.references.size());
  assertEquals(var3Refs.references.get(0),refs.references.get(0));
}
