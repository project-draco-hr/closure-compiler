{
  MemoizedScopeCreator oldScopeCreator=typedScopeCreator;
  typedScopeCreator=new MemoizedScopeCreator(new TypedScopeCreator(compiler));
  topScope=typedScopeCreator.createScope(root,null);
  if (oldScopeCreator != null) {
    Scope oldTopScope=oldScopeCreator.getScopeIfMemoized(root);
    if (oldTopScope != null) {
      Iterator<Var> varIt=topScope.getDeclarativelyUnboundVarsWithoutTypes();
      while (varIt.hasNext()) {
        Var newVar=varIt.next();
        Var oldVar=oldTopScope.getVar(newVar.getName());
        if (oldVar != null) {
          newVar.setType(oldVar.getType());
        }
      }
    }
  }
}
