{
  Compiler compiler=compile(original);
  assertEquals("Expected exactly one warning or error " + "Errors: \n" + Joiner.on("\n").join(compiler.getErrors()) + "Warnings: \n"+ Joiner.on("\n").join(compiler.getWarnings()),1,compiler.getErrors().length + compiler.getWarnings().length);
  assertTrue(exitCodes.size() > 0);
  int lastExitCode=exitCodes.get(exitCodes.size() - 1);
  if (compiler.getErrors().length > 0) {
    assertEquals(1,compiler.getErrors().length);
    assertEquals(warning,compiler.getErrors()[0].getType());
    assertEquals(1,lastExitCode);
  }
 else {
    assertEquals(1,compiler.getWarnings().length);
    assertEquals(warning,compiler.getWarnings()[0].getType());
    assertEquals(0,lastExitCode);
  }
}
