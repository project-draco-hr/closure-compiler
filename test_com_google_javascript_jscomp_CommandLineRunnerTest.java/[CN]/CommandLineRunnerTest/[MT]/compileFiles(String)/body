{
  String[] argStrings=args.toArray(new String[]{});
  CommandLineRunner runner=new CommandLineRunner(argStrings,new PrintStream(outReader),new PrintStream(errReader));
  lastCompiler=runner.getCompiler();
  try {
    runner.doRun();
  }
 catch (  IOException e) {
    e.printStackTrace();
    fail("Unexpected exception " + e);
  }
  String output=runner.getCompiler().toSource();
  assertThat(output).isEqualTo(expectedOutput);
}
