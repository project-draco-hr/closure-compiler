{
  Compiler compiler=new Compiler();
  CompilerOptions options=new CompilerOptions();
  options.sourceMapOutputPath="testcode_source_map.out";
  options.ideMode=true;
  JSSourceFile[] inputs={JSSourceFile.fromCode(fileName1,js1)};
  if (js2 != null && fileName2 != null) {
    JSSourceFile[] multiple={JSSourceFile.fromCode(fileName1,js1),JSSourceFile.fromCode(fileName2,js2)};
    inputs=multiple;
  }
  Result result=compiler.compile(EXTERNS,inputs,options);
  assertTrue(result.success);
  String source=compiler.toSource();
  RunResult rr=new RunResult();
  rr.generatedSource=source;
  rr.sourceMap=result.sourceMap;
  return rr;
}
