{
  Node value=init.getAssignedValue();
  Preconditions.checkState(value != null);
  boolean isFunctionDeclaration=NodeUtil.isFunctionDeclaration(value);
  compiler.reportChangeToScope(compiler.getEnclosingScope(decl.getNode()));
  compiler.reportChangeToScope(compiler.getEnclosingScope(ref.getNode()));
  inlineValue(v,ref,value.detachFromParent());
  if (decl != init) {
    Node expressRoot=init.getGrandparent();
    Preconditions.checkState(expressRoot.isExprResult());
    NodeUtil.removeChild(expressRoot.getParent(),expressRoot);
  }
  if (!isFunctionDeclaration) {
    removeDeclaration(decl);
  }
}
