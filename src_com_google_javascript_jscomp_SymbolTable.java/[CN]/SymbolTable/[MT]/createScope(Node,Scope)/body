{
  Preconditions.checkArgument(n.getType() == Token.BLOCK || n.getType() == Token.FUNCTION);
  ensureCacheInitialized();
  if (!cache.scopes.containsKey(n)) {
    cache.scopes.put(n,scopeCreator.createScope(n,parent));
  }
  return cache.scopes.get(n);
}
