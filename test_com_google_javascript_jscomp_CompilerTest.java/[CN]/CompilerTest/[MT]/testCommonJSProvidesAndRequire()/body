{
  List<SourceFile> inputs=Lists.newArrayList(SourceFile.fromCode("gin.js","require('tonic')"),SourceFile.fromCode("tonic.js",""),SourceFile.fromCode("mix.js","require('gin'); require('tonic');"));
  CompilerOptions options=new CompilerOptions();
  options.ideMode=true;
  List<String> entryPoints=Lists.newArrayList("module$mix");
  options.setManageClosureDependencies(entryPoints);
  options.closurePass=true;
  options.processCommonJSModules=true;
  Compiler compiler=new Compiler();
  compiler.init(Lists.<SourceFile>newArrayList(),inputs,options);
  compiler.parseInputs();
  JSModuleGraph graph=compiler.getModuleGraph();
  assertEquals(graph.getModuleCount(),3);
  List<CompilerInput> result=graph.manageDependencies(entryPoints,compiler.getInputsForTesting());
  assertEquals("[module$tonic]",result.get(0).getName());
  assertEquals("[module$gin]",result.get(1).getName());
  assertEquals("tonic.js",result.get(2).getName());
  assertEquals("gin.js",result.get(3).getName());
  assertEquals("mix.js",result.get(4).getName());
}
