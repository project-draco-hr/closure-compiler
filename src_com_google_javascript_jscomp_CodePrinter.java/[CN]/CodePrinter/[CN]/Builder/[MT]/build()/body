{
  if (root == null) {
    throw new IllegalStateException("Cannot build without root node being specified");
  }
  Format outputFormat=outputTypes ? Format.TYPED : options.prettyPrint ? Format.PRETTY : Format.COMPACT;
  return toSource(root,outputFormat,options,sourceMap,tagAsStrict);
}
