{
  Node insertSpot=null;
  Node body=function.getLastChild();
  for (int i=0; i < paramList.getChildCount(); i++) {
    Node param=paramList.getChildAtIndex(i);
    if (param.isDefaultValue()) {
      JSDocInfo jsDoc=param.getJSDocInfo();
      Node nameOrPattern=param.removeFirstChild();
      Node defaultValue=param.removeFirstChild();
      Node newParam;
      boolean isNoop=false;
      if (!nameOrPattern.isName()) {
      }
 else       if (defaultValue.isName()) {
        isNoop="undefined".equals(defaultValue.getString());
      }
 else       if (defaultValue.isVoid()) {
        isNoop=NodeUtil.isImmutableValue(defaultValue.getFirstChild());
      }
      if (isNoop) {
        newParam=nameOrPattern.cloneTree();
      }
 else {
        newParam=nameOrPattern.isName() ? nameOrPattern : IR.name(DESTRUCTURING_TEMP_VAR + (destructuringVarCounter++));
        Node lhs=nameOrPattern.cloneTree();
        Node rhs=defaultValueHook(newParam.cloneTree(),defaultValue);
        Node newStatement=nameOrPattern.isName() ? IR.exprResult(IR.assign(lhs,rhs)) : IR.var(lhs,rhs);
        newStatement.useSourceInfoIfMissingFromForTree(param);
        body.addChildAfter(newStatement,insertSpot);
        insertSpot=newStatement;
      }
      paramList.replaceChild(param,newParam);
      newParam.setOptionalArg(true);
      newParam.setJSDocInfo(jsDoc);
      compiler.reportCodeChange();
    }
 else     if (param.isDestructuringPattern()) {
      String tempVarName=DESTRUCTURING_TEMP_VAR + (destructuringVarCounter++);
      paramList.replaceChild(param,IR.name(tempVarName));
      Node newDecl=IR.var(param,IR.name(tempVarName));
      body.addChildAfter(newDecl,insertSpot);
      insertSpot=newDecl;
      compiler.reportCodeChange();
    }
  }
}
