{
  ParseTreeValidator validator=new ParseTreeValidator();
  try {
    validator.visitAny(tree);
  }
 catch (  RuntimeException e) {
    SourceRange location=null;
    if (validator.lastVisited != null) {
      location=validator.lastVisited.location;
    }
    if (location == null) {
      location=tree.location;
    }
    String locationString=location != null ? location.start.toString() : "(unknown)";
    throw new RuntimeException("Parse tree validation failure '" + e.getMessage() + "' at "+ locationString+ ":\n\n"+ ParseTreeWriter.write(tree,validator.lastVisited,true)+ "\n",e);
  }
}
