{
  HashMap<List<String>,Double> pmf=new HashMap<List<String>,Double>();
  int i;
  for (i=0; i < storage.size() - 1; i++) {
    List<String> scope=storage.get(i);
    pmf.put(scope,Double.valueOf(scope.size()));
  }
  if (!excludeLocal) {
    List<String> scope=storage.get(i);
    pmf.put(scope,Double.valueOf(scope.size()));
  }
  DiscreteDistribution<List<String>> distribution=new DiscreteDistribution<List<String>>(random,pmf);
  return distribution.nextItem();
}
