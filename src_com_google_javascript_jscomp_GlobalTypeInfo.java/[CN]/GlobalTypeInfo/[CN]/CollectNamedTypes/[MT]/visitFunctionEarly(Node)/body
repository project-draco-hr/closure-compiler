{
  JSDocInfo fnDoc=NodeUtil.getBestJSDocInfo(fn);
  Node nameNode=NodeUtil.getNameNode(fn);
  String internalName=createFunctionInternalName(fn,nameNode);
  boolean isRedeclaration;
  if (nameNode == null || !nameNode.isQualifiedName()) {
    isRedeclaration=false;
  }
 else   if (nameNode.isName()) {
    isRedeclaration=currentScope.isDefinedLocally(nameNode.getString(),false);
  }
 else {
    isRedeclaration=currentScope.isDefined(nameNode);
  }
  NTIScope fnScope=new NTIScope(fn,this.currentScope,collectFormals(fn,fnDoc),null);
  if (!fn.isFromExterns()) {
    scopes.add(fnScope);
  }
  this.currentScope.addLocalFunDef(internalName,fnScope);
  maybeRecordNominalType(fn,nameNode,fnDoc,isRedeclaration);
}
