{
  Preconditions.checkState(!isFinalized);
  if (type == null && isConstant) {
    type=JSType.UNKNOWN;
  }
  if (this.classProps.containsKey(pname) && this.classProps.get(pname).getDeclaredType() == null) {
    this.classProps=this.classProps.without(pname);
  }
  if (this.randomProps.containsKey(pname)) {
    this.randomProps=this.randomProps.without(pname);
  }
  this.protoProps=this.protoProps.with(pname,isConstant ? Property.makeConstant(defSite,type,type) : Property.makeWithDefsite(defSite,type,type));
}
