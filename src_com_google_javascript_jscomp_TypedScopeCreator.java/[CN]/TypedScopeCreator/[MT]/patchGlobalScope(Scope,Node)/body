{
  Preconditions.checkState(scriptRoot.getType() == Token.SCRIPT);
  Preconditions.checkNotNull(globalScope);
  Preconditions.checkState(globalScope.isGlobal());
  String scriptName=NodeUtil.getSourceName(scriptRoot);
  Preconditions.checkNotNull(scriptName);
  for (  Node node : ImmutableList.copyOf(functionAnalysisResults.keySet())) {
    if (scriptName.equals(NodeUtil.getSourceName(node))) {
      functionAnalysisResults.remove(node);
    }
  }
  (new FirstOrderFunctionAnalyzer(compiler,functionAnalysisResults)).process(null,scriptRoot);
  Iterator<Var> varIter=globalScope.getVars();
  List<Var> varsToRemove=Lists.newArrayList();
  while (varIter.hasNext()) {
    Var oldVar=varIter.next();
    if (scriptName.equals(oldVar.getInputName())) {
      varsToRemove.add(oldVar);
    }
  }
  for (  Var var : varsToRemove) {
    globalScope.undeclare(var);
    globalScope.getTypeOfThis().removeProperty(var.getName());
  }
  GlobalScopeBuilder scopeBuilder=new GlobalScopeBuilder(globalScope);
  NodeTraversal.traverse(compiler,scriptRoot,scopeBuilder);
}
