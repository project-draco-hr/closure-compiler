{
  Compiler compiler=new Compiler();
  CompilerOptions options=new CompilerOptions();
  options.externExportsPath="externs.js";
  options.ideMode=false;
  options.checkSymbols=true;
  options.checkTypes=runCheckTypes;
  List<SourceFile> inputs=Lists.newArrayList(SourceFile.fromCode("testcode","var goog = {};" + "goog.exportSymbol = function(a, b) {}; " + "goog.exportProperty = function(a, b, c) {}; "+ js));
  List<SourceFile> externFiles=Lists.newArrayList(SourceFile.fromCode("externs",externs));
  Result result=compiler.compile(externFiles,inputs,options);
  if (!result.success) {
    String msg="Errors:";
    msg+=Joiner.on("\n").join(result.errors);
    assertTrue(msg,result.success);
  }
  return result;
}
