{
  this.runTightenTypes=runTightenTypes;
  Compiler compiler=new Compiler();
  CompilerOptions options=new CompilerOptions();
  compiler.init(ImmutableList.of(SourceFile.fromCode("externs","")),ImmutableList.of(SourceFile.fromCode("testcode",js)),options);
  Node root=compiler.parseInputs();
  assertTrue("Unexpected parse error(s): " + Joiner.on("\n").join(compiler.getErrors()),root != null);
  Node externsRoot=root.getFirstChild();
  Node mainRoot=externsRoot.getNext();
  getProcessor(compiler).process(externsRoot,mainRoot);
  assertEquals(fieldTypes,mapToString(lastPass.getRenamedTypesForTesting()));
}
