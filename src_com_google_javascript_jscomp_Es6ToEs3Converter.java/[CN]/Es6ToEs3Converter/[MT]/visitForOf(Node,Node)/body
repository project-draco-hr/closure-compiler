{
  Node variable=node.removeFirstChild();
  Node iterable=node.removeFirstChild();
  Node body=node.removeFirstChild();
  Node iterName=IR.name(ITER_BASE + compiler.getUniqueNameIdSupplier().get());
  Node getNext=IR.call(IR.getprop(iterName.cloneTree(),IR.string("next")));
  String variableName;
  int declType;
  if (variable.isName()) {
    declType=Token.NAME;
    variableName=variable.getQualifiedName();
  }
 else {
    Preconditions.checkState(NodeUtil.isNameDeclaration(variable),"Expected var, let, or const. Got %s",variable);
    declType=variable.getType();
    variableName=variable.getFirstChild().getQualifiedName();
  }
  Node iterResult=IR.name(ITER_RESULT + variableName);
  Node makeIter=IR.call(NodeUtil.newQName(compiler,MAKE_ITER),iterable);
  compiler.needsEs6Runtime=true;
  Node init=IR.var(iterName.cloneTree(),makeIter);
  Node initIterResult=iterResult.cloneTree();
  initIterResult.addChildToFront(getNext.cloneTree());
  init.addChildToBack(initIterResult);
  Node cond=IR.not(IR.getprop(iterResult.cloneTree(),IR.string("done")));
  Node incr=IR.assign(iterResult.cloneTree(),getNext.cloneTree());
  Node declarationOrAssign;
  if (declType == Token.NAME) {
    declarationOrAssign=IR.exprResult(IR.assign(IR.name(variableName),IR.getprop(iterResult.cloneTree(),IR.string("value"))));
  }
 else {
    declarationOrAssign=new Node(declType,IR.name(variableName));
    declarationOrAssign.getFirstChild().addChildToBack(IR.getprop(iterResult.cloneTree(),IR.string("value")));
  }
  body.addChildToFront(declarationOrAssign);
  Node newFor=IR.forNode(init,cond,incr,body);
  newFor.useSourceInfoIfMissingFromForTree(node);
  parent.replaceChild(node,newFor);
  compiler.reportCodeChange();
}
