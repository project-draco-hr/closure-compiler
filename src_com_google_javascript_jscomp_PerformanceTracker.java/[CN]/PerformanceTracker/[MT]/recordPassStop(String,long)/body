{
  String currentPassName=currentRunningPass.pop();
  if (!passName.equals(currentPassName)) {
    throw new RuntimeException(passName + " is not running.");
  }
  CodeSizeEstimatePrinter printer=null;
  if (codeChange.hasCodeChanged() && (trackSize || trackGzippedSize)) {
    printer=estimateCodeSize(jsRoot);
  }
  Stats logStats=new Stats(currentPassName);
  log.add(logStats);
  updateStats(logStats,result,printer);
  Stats summaryStats=summary.get(passName);
  if (summaryStats == null) {
    summaryStats=new Stats(passName);
    summary.put(passName,summaryStats);
  }
  updateStats(summaryStats,result,printer);
  if (printer != null) {
    if (trackSize) {
      curCodeSizeEstimate=printer.calcSize();
    }
    if (trackGzippedSize) {
      curZippedCodeSizeEstimate=printer.calcZippedSize();
    }
  }
}
