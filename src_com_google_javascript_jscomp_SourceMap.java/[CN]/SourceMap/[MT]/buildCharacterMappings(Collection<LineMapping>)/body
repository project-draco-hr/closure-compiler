{
  for (  LineMapping lineMapping : lineMappings) {
    for (int i=0; i <= lineMapping.length; ++i) {
      int minLength=Integer.MAX_VALUE;
      LineCharMapping current=null;
      Collections.sort(lineMapping.characterMappings,new Comparator<LineCharMapping>(){
        @Override public int compare(        LineCharMapping first,        LineCharMapping second){
          Mapping firstBasis=first.basisMapping;
          Mapping secondBasis=second.basisMapping;
          String firstName=firstBasis.originalName;
          String secondName=secondBasis.originalName;
          firstName=firstName == null ? "" : firstName;
          secondName=secondName == null ? "" : secondName;
          return firstName.compareTo(secondName);
        }
      }
);
      for (      LineCharMapping lcm : lineMapping.characterMappings) {
        if (i < lcm.startCharacter || i > lcm.endCharacter) {
          continue;
        }
        int lcmLength=lcm.endCharacter - lcm.startCharacter;
        if (lcmLength == minLength && lcm.basisMapping.originalName != null) {
          current=lcm;
          continue;
        }
        if (lcmLength < minLength) {
          minLength=lcmLength;
          current=lcm;
        }
      }
      lineMapping.charToMap.put(i,current);
    }
  }
}
