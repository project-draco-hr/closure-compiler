{
  Typedef td=registry.getTypedef(name);
  Preconditions.checkState(td != null,"getTypedef should only be " + "called when we know that the typedef is defined");
  if (td.isResolved()) {
    return td.getType();
  }
  JSTypeExpression texp=td.getTypeExpr();
  JSType tdType;
  if (texp == null) {
    warn("Circular typedefs are not allowed.",td.getTypeExprForErrorReporting().getRootNode());
    tdType=JSType.UNKNOWN;
  }
 else {
    tdType=getTypeFromJSTypeExpression(texp,null,registry,null);
  }
  td.resolveTypedef(tdType);
  return tdType;
}
