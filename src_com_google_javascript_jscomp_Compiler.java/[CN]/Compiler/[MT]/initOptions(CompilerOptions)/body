{
  this.options=options;
  if (errorManager == null) {
    if (outStream == null) {
      setErrorManager(new LoggerErrorManager(createMessageFormatter(),logger));
    }
 else {
      PrintStreamErrorManager printer=new PrintStreamErrorManager(createMessageFormatter(),outStream);
      printer.setSummaryDetailLevel(options.summaryDetailLevel);
      setErrorManager(printer);
    }
  }
  List<WarningsGuard> guards=Lists.newArrayList();
  guards.add(new SuppressDocWarningsGuard(getDiagnosticGroups().getRegisteredGroups()));
  WarningsGuard warningsGuard=options.getWarningsGuard();
  if (warningsGuard != null) {
    guards.add(options.getWarningsGuard());
  }
  if (!options.checkSymbols && (warningsGuard == null || !warningsGuard.disables(DiagnosticGroups.CHECK_VARIABLES))) {
    guards.add(new DiagnosticGroupWarningsGuard(DiagnosticGroups.CHECK_VARIABLES,CheckLevel.OFF));
  }
  this.warningsGuard=new ComposeWarningsGuard(guards);
}
