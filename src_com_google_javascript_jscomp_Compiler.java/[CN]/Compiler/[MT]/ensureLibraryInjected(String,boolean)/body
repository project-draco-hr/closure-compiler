{
  if (injectedLibraries.containsKey(resourceName) || options.preventLibraryInjection.contains(resourceName)) {
    return null;
  }
  boolean isBase="base".equals(resourceName);
  if (!isBase) {
    ensureLibraryInjected("base",true);
  }
  Node firstChild=loadLibraryCode(resourceName,normalizeAndUniquifyNames).removeChildren();
  Node lastChild=firstChild.getLastSibling();
  Node parent=getNodeForCodeInsertion(null);
  if (isBase || options.preventLibraryInjection.contains("base")) {
    parent.addChildrenToFront(firstChild);
  }
 else {
    parent.addChildrenAfter(firstChild,injectedLibraries.get("base"));
  }
  reportCodeChange();
  injectedLibraries.put(resourceName,lastChild);
  return lastChild;
}
