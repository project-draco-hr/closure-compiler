{
  if (n.getType() == Token.FUNCTION) {
    if (inputId == null) {
      inputId=NodeUtil.getInputId(n);
      Preconditions.checkNotNull(inputId);
    }
    final Node fnNameNode=n.getFirstChild();
    final Node args=fnNameNode.getNext();
    final Node body=args.getNext();
    String fnName=fnNameNode.getString();
    if (!fnName.isEmpty() && NodeUtil.isFunctionExpression(n)) {
      declareVar(fnNameNode);
    }
    Preconditions.checkState(args.getType() == Token.LP);
    for (Node a=args.getFirstChild(); a != null; a=a.getNext()) {
      Preconditions.checkState(a.getType() == Token.NAME);
      declareVar(a);
    }
    scanVars(body,n);
  }
 else {
    Preconditions.checkState(scope.getParent() == null);
    scanVars(n,null);
  }
}
