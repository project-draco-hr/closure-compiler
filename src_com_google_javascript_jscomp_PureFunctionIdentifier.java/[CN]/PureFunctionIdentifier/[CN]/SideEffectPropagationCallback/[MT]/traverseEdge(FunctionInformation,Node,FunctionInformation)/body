{
  Preconditions.checkArgument(callSite.isCall() || callSite.isNew());
  boolean changed=false;
  if (!caller.mutatesGlobalState() && callee.mutatesGlobalState()) {
    caller.setTaintsGlobalState();
    changed=true;
  }
  if (!caller.functionThrows() && callee.functionThrows()) {
    caller.setFunctionThrows();
    changed=true;
  }
  if (!caller.mutatesGlobalState() && callee.mutatesArguments() && !NodeUtil.allArgsUnescapedLocal(callSite)) {
    caller.setTaintsGlobalState();
    changed=true;
  }
  if (callee.mutatesThis()) {
    if (!callSite.isNew()) {
      boolean isCallOrApply=isCallOrApply(callSite);
      Node objectNode=isCallOrApply ? callSite.getSecondChild() : callSite.getFirstGrandchild();
      if (objectNode != null && objectNode.isName() && !isCallOrApply) {
        if (!caller.mutatesGlobalState()) {
          caller.setTaintsGlobalState();
          changed=true;
        }
      }
 else       if (objectNode != null && objectNode.isThis()) {
        if (!caller.mutatesThis()) {
          caller.setTaintsThis();
          changed=true;
        }
      }
 else       if (objectNode != null && NodeUtil.evaluatesToLocalValue(objectNode) && !isCallOrApply) {
      }
 else       if (!caller.mutatesGlobalState()) {
        caller.setTaintsGlobalState();
        changed=true;
      }
    }
  }
  return changed;
}
