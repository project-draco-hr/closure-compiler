{
  Node condition=currentStatement.removeFirstChild();
  Node ifBody=currentStatement.removeFirstChild();
  boolean hasElse=currentStatement.hasChildren();
  int ifEndState=generatorCaseCount++;
  Node safeBreak=IR.breakNode();
  safeBreak.setGeneratorSafe(true);
  Node invertedConditional=IR.ifNode(IR.not(condition),IR.block(createStateUpdate(ifEndState),safeBreak));
  invertedConditional.setGeneratorSafe(true);
  Node endIf=IR.number(ifEndState);
  endIf.setGeneratorMarker(true);
  originalGeneratorBody.addChildToFront(invertedConditional);
  originalGeneratorBody.addChildAfter(ifBody,invertedConditional);
  originalGeneratorBody.addChildAfter(endIf,ifBody);
  if (hasElse) {
    Node elseBlock=currentStatement.removeFirstChild();
    int elseEndState=generatorCaseCount++;
    Node endElse=IR.number(elseEndState);
    endElse.setGeneratorMarker(true);
    ifBody.addChildToBack(createStateUpdate(elseEndState));
    ifBody.addChildToBack(safeBreak.cloneTree());
    originalGeneratorBody.addChildAfter(elseBlock,endIf);
    originalGeneratorBody.addChildAfter(endElse,elseBlock);
  }
}
