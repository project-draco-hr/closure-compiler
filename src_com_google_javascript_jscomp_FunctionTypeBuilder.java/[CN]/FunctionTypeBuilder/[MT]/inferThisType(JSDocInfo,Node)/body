{
  ObjectType maybeThisType=null;
  if (info != null && info.hasThisType()) {
    maybeThisType=ObjectType.cast(info.getThisType().evaluate(scope,typeRegistry));
  }
  if (maybeThisType != null) {
    thisType=maybeThisType;
    thisType.setValidator(new ThisTypeValidator());
  }
 else   if (owner != null && (info == null || !info.hasType())) {
    String ownerTypeName=owner.getQualifiedName();
    ObjectType ownerType=ObjectType.cast(typeRegistry.getForgivingType(scope,ownerTypeName,sourceName,owner.getLineno(),owner.getCharno()));
    if (ownerType != null) {
      thisType=ownerType;
    }
  }
  return this;
}
