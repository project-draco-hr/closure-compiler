{
  test(LINE_JOINER.join("const arr = [];","for (let i = 0; i < 10; i++) {","  arr.push(function() { return i; });","}"),LINE_JOINER.join("/** @const */ var arr = [];","var $jscomp$loop$0 = {i: undefined};","$jscomp$loop$0.i = 0;","for (; $jscomp$loop$0.i < 10;","    $jscomp$loop$0 = {i: $jscomp$loop$0.i}, $jscomp$loop$0.i++) {","  arr.push((function($jscomp$loop$0) {","      return function() { return $jscomp$loop$0.i; };","  })($jscomp$loop$0));","}"));
  test(LINE_JOINER.join("const arr = [];","for (let i = 0; i < 10; i++) {","  let y = i;","  arr.push(function() { return y; });","}"),LINE_JOINER.join("/** @const */ var arr = [];","var $jscomp$loop$0 = {y: undefined};","var i = 0;","for (; i < 10; $jscomp$loop$0 = {y: $jscomp$loop$0.y}, i++) {","  $jscomp$loop$0.y = i;","  arr.push((function($jscomp$loop$0) {","      return function() { return $jscomp$loop$0.y; };","  })($jscomp$loop$0));","}"));
  test(LINE_JOINER.join("const arr = [];","while (true) {","  let i = 0;","  arr.push(function() { return i; });","}"),LINE_JOINER.join("/** @const */ var arr = [];","var $jscomp$loop$0 = {i: undefined}","while (true) {","  $jscomp$loop$0.i = 0;","  arr.push((function($jscomp$loop$0) {","      return function() { return $jscomp$loop$0.i; };","  })($jscomp$loop$0));","  $jscomp$loop$0 = {i: $jscomp$loop$0.i}","}"));
  test(LINE_JOINER.join("const arr = [];","for (let i = 0; i < 10; i++) {","  let y = i;","  arr.push(function() { return y + i; });","}"),LINE_JOINER.join("/** @const */ var arr = [];","var $jscomp$loop$0 = {y: undefined, i: undefined};","$jscomp$loop$0.i = 0;","for (; $jscomp$loop$0.i < 10;","    $jscomp$loop$0 = {y: $jscomp$loop$0.y, i: $jscomp$loop$0.i},","        $jscomp$loop$0.i++) {","  $jscomp$loop$0.y = $jscomp$loop$0.i;","  arr.push((function($jscomp$loop$0) {","          return function() {","              return $jscomp$loop$0.y + $jscomp$loop$0.i;","          };","  }($jscomp$loop$0)));","}"));
  test(LINE_JOINER.join("const arr = [];","let x = 0","for (let i = 0; i < 10; i++) {","  let i = x + 1;","  arr.push(function() { return i + i; });","  x++;","}"),LINE_JOINER.join("/** @const */ var arr = [];","var x = 0","var $jscomp$loop$1 = {i$0: undefined};","var i = 0;","for (; i < 10; $jscomp$loop$1 = {i$0: $jscomp$loop$1.i$0}, i++) {","  $jscomp$loop$1.i$0 = x + 1;","  arr.push((function($jscomp$loop$1) {","      return function() {","          return $jscomp$loop$1.i$0 + $jscomp$loop$1.i$0;","      };","  }($jscomp$loop$1)));","  x++;","}"));
  test(LINE_JOINER.join("const arr = [];","let x = 0","for (let i = 0; i < 10; i++) {","  arr.push(function() { return i + i; });","  let i = x + 1;","  arr.push(function() { return i + i; });","  x++;","}"),LINE_JOINER.join("/** @const */ var arr = [];","var x = 0","var $jscomp$loop$1 = {i$0: undefined};","var i = 0;","for (; i < 10; $jscomp$loop$1 = {i$0: $jscomp$loop$1.i$0}, i++) {","  arr.push((function($jscomp$loop$1) {","      return function() {","          return $jscomp$loop$1.i$0 + $jscomp$loop$1.i$0;","      };","  }($jscomp$loop$1)));","  $jscomp$loop$1.i$0 = x + 1;","  arr.push((function($jscomp$loop$1) {","      return function() {","          return $jscomp$loop$1.i$0 + $jscomp$loop$1.i$0;","      };","  }($jscomp$loop$1)));","  x++;","}"));
  test(LINE_JOINER.join("for (let i = 0; i < 10; i++) {","  if (true) {","    let i = x - 1;","    arr.push(function() { return i + i; });","  }","  let i = x + 1;","  arr.push(function() { return i + i; });","  x++;","}"),LINE_JOINER.join("var $jscomp$loop$2 = {i$0 : undefined, i$1: undefined};","var i = 0;","for (; i < 10;","    $jscomp$loop$2 = {i$0: $jscomp$loop$2.i$0, i$1: $jscomp$loop$2.i$1}, i++) {","  if (true) {","    $jscomp$loop$2.i$0 = x - 1;","    arr.push((function($jscomp$loop$2) {","        return function() { return $jscomp$loop$2.i$0 + $jscomp$loop$2.i$0; };","    })($jscomp$loop$2));","  }","  $jscomp$loop$2.i$1 = x + 1;","  arr.push((function($jscomp$loop$2) {","      return function() { return $jscomp$loop$2.i$1 + $jscomp$loop$2.i$1; };","  })($jscomp$loop$2));","  x++;","}"));
  test("for (;;) { /** @type {number} */ let x = 3; var f = function() { return x; } }",LINE_JOINER.join("var $jscomp$loop$0 = {x: undefined};","for (;;$jscomp$loop$0 = {x: $jscomp$loop$0.x}) {","  /** @type {number} */ $jscomp$loop$0.x = 3;","  var f = function($jscomp$loop$0) {","    return function() { return $jscomp$loop$0.x}","  }($jscomp$loop$0);","}"));
  test("for (;;) { const /** number */ x = 3; var f = function() { return x; } }",LINE_JOINER.join("var $jscomp$loop$0 = {x: undefined};","for (;;$jscomp$loop$0 = {x: $jscomp$loop$0.x}) {","  /** @const @type {number} */ $jscomp$loop$0.x = 3;","  var f = function($jscomp$loop$0) {","    return function() { return $jscomp$loop$0.x}","  }($jscomp$loop$0);","}"));
  testSame("for (;;) { var /** number */ x = 3; var f = function() { return x; } }");
  test(LINE_JOINER.join("var i;","for (i = 0;;) {","  let x = 0;","  var f = function() { x; };","}"),LINE_JOINER.join("var i;","var $jscomp$loop$0={x: undefined};","i = 0;","for(;;$jscomp$loop$0 = {x: $jscomp$loop$0.x}) {","  $jscomp$loop$0.x = 0;","  var f = (function($jscomp$loop$0) {","    return function() { $jscomp$loop$0.x; };","  })($jscomp$loop$0);","}"));
  test(LINE_JOINER.join("for (foo();;) {","  let x = 0;","  var f = function() { x; };","}"),LINE_JOINER.join("var $jscomp$loop$0={x: undefined};","foo();","for(;;$jscomp$loop$0 = {x: $jscomp$loop$0.x}) {","  $jscomp$loop$0.x = 0;","  var f = (function($jscomp$loop$0) {","    return function() { $jscomp$loop$0.x; };","  })($jscomp$loop$0);","}"));
  test(LINE_JOINER.join("for (function foo() {};;) {","  let x = 0;","  var f = function() { x; };","}"),LINE_JOINER.join("var $jscomp$loop$0={x: undefined};","(function foo() {});","for(;;$jscomp$loop$0 = {x: $jscomp$loop$0.x}) {","  $jscomp$loop$0.x = 0;","  var f = (function($jscomp$loop$0) {","    return function() { $jscomp$loop$0.x; };","  })($jscomp$loop$0);","}"));
}
