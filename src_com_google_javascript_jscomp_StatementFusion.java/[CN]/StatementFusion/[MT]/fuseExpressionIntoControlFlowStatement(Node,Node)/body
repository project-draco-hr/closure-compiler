{
  Preconditions.checkArgument(before.isExprResult(),"before must be expression result");
switch (control.getType()) {
case Token.IF:
case Token.RETURN:
case Token.THROW:
case Token.SWITCH:
case Token.EXPR_RESULT:
    before.getParent().removeChild(before);
  fuseExpressionIntoFirstChild(before.removeFirstChild(),control);
return;
case Token.FOR:
before.getParent().removeChild(before);
if (NodeUtil.isForIn(control)) {
fuseExpressionIntoSecondChild(before.removeFirstChild(),control);
}
 else {
fuseExpressionIntoFirstChild(before.removeFirstChild(),control);
}
return;
case Token.LABEL:
fuseExpressionIntoControlFlowStatement(before,control.getLastChild());
return;
case Token.BLOCK:
fuseExpressionIntoControlFlowStatement(before,control.getFirstChild());
return;
default :
throw new IllegalStateException("Statement fusion missing.");
}
}
