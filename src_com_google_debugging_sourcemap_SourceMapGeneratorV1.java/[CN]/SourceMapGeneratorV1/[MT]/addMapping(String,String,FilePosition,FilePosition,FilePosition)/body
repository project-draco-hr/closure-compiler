{
  if (sourceName == null || sourceStartPosition.getLine() < 0) {
    return;
  }
  Mapping mapping=new Mapping();
  mapping.sourceFile=sourceName;
  mapping.originalPosition=sourceStartPosition;
  mapping.originalName=symbolName;
  if (offsetPosition.getLine() == 0 && offsetPosition.getColumn() == 0) {
    mapping.startPosition=startPosition;
    mapping.endPosition=endPosition;
  }
 else {
    int offsetLine=offsetPosition.getLine();
    int startOffsetPosition=offsetPosition.getColumn();
    int endOffsetPosition=offsetPosition.getColumn();
    if (startPosition.getLine() > 0) {
      startOffsetPosition=0;
    }
    if (endPosition.getLine() > 0) {
      endOffsetPosition=0;
    }
    mapping.startPosition=new FilePosition(startPosition.getLine() + offsetLine,startPosition.getColumn() + startOffsetPosition);
    mapping.endPosition=new FilePosition(endPosition.getLine() + offsetLine,endPosition.getColumn() + endOffsetPosition);
  }
  if (lastMapping != null) {
    int lastLine=lastMapping.startPosition.getLine();
    int lastColumn=lastMapping.startPosition.getColumn();
    int nextLine=mapping.startPosition.getLine();
    int nextColumn=mapping.startPosition.getColumn();
    Preconditions.checkState(nextLine > lastLine || (nextLine == lastLine && nextColumn >= lastColumn),"Incorrect source mappings order, previous : (%s,%s)\n" + "new : (%s,%s)\nnode : %s",lastLine,lastColumn,nextLine,nextColumn);
  }
  lastMapping=mapping;
  mappings.add(mapping);
}
